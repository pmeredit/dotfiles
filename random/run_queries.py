import yaml
import mysql.connector

queries = set([
    'micro_normalized_1',
     'micro_normalized_2',
     'micro_normalized_3',
     'micro_normalized_4',
     'micro_normalized_6',
     'micro_normalized_7',
     'micro_normalized_8',
     'micro_normalized_9',
     'micro_normalized_10',
     'micro_normalized_11',
     'micro_normalized_12',
     'micro_normalized_13',
     'micro_normalized_14',
     'micro_normalized_15',
     'micro_normalized_16',
     'micro_normalized_17',
     'micro_normalized_18',
     'micro_normalized_19',
     'micro_normalized_20',
     'micro_normalized_21',
     'micro_normalized_22',
     'micro_denormalized_0',
     'micro_denormalized_1',
     'micro_denormalized_2',
     'micro_denormalized_3',
     'micro_denormalized_4',
     'micro_denormalized_5',
     'micro_denormalized_6',
     'micro_denormalized_7',
     'micro_denormalized_8',
     'micro_denormalized_9',
     'micro_denormalized_10',
     'micro_denormalized_11',
     'micro_denormalized_12',
     'micro_denormalized_13',
     'micro_denormalized_14',
     'micro_denormalized_15',
     'micro_denormalized_16',
     'micro_denormalized_17',
     'micro_denormalized_18',
     'micro_denormalized_19',
     'micro_denormalized_20',
     'micro_denormalized_21',
     'micro_handwritten_denormalized_0',
     'micro_handwritten_denormalized_1',
     'micro_handwritten_denormalized_2',
     'micro_handwritten_denormalized_3',
     'micro_handwritten_denormalized_4',
     'micro_handwritten_denormalized_5',
     'micro_handwritten_denormalized_6',
     'micro_handwritten_denormalized_7',
     'micro_handwritten_denormalized_8',
     'micro_handwritten_denormalized_9',
     'micro_handwritten_denormalized_10',
     'micro_handwritten_denormalized_11',
     'micro_handwritten_denormalized_12',
     'micro_handwritten_denormalized_13',
     'micro_handwritten_denormalized_14',
     'micro_handwritten_denormalized_15',
     'micro_handwritten_denormalized_16',
     'micro_handwritten_denormalized_17',
     'micro_handwritten_denormalized_18',
     'micro_handwritten_denormalized_19',
     'micro_handwritten_denormalized_20',
     'micro_handwritten_denormalized_21',
     'micro_handwritten_denormalized_22',
     'full_normalized_1',
     'full_normalized_2',
     'full_normalized_3',
     'full_normalized_4',
     'full_normalized_6',
     'full_normalized_7',
     'full_normalized_8',
     'full_normalized_9',
     'full_normalized_10',
     'full_normalized_11',
     'full_normalized_12',
     'full_normalized_13',
     'full_normalized_14',
     'full_normalized_15',
     'full_normalized_16',
     'full_normalized_17',
     'full_normalized_18',
     'full_normalized_19',
     'full_normalized_20',
     'full_normalized_21',
     'full_normalized_22',
     'full_denormalized_0',
     'full_denormalized_1',
     'full_denormalized_2',
     'full_denormalized_3',
     'full_denormalized_4',
     'full_denormalized_5',
     'full_denormalized_6',
     'full_denormalized_7',
     'full_denormalized_8',
     'full_denormalized_9',
     'full_denormalized_10',
     'full_denormalized_11',
     'full_denormalized_12',
     'full_denormalized_13',
     'full_denormalized_14',
     'full_denormalized_15',
     'full_denormalized_16',
     'full_denormalized_17',
     'full_denormalized_18',
     'full_denormalized_19',
     'full_denormalized_20',
     'full_denormalized_21',
     'full_handwritten_denormalized_0',
     'full_handwritten_denormalized_1',
     'full_handwritten_denormalized_2',
     'full_handwritten_denormalized_3',
     'full_handwritten_denormalized_4',
     'full_handwritten_denormalized_5',
     'full_handwritten_denormalized_6',
     'full_handwritten_denormalized_7',
     'full_handwritten_denormalized_8',
     'full_handwritten_denormalized_9',
     'full_handwritten_denormalized_10',
     'full_handwritten_denormalized_11',
     'full_handwritten_denormalized_12',
     'full_handwritten_denormalized_13',
     'full_handwritten_denormalized_14',
     'full_handwritten_denormalized_15',
     'full_handwritten_denormalized_16',
     'full_handwritten_denormalized_17',
     'full_handwritten_denormalized_18',
     'full_handwritten_denormalized_19',
     'full_handwritten_denormalized_20',
     'full_handwritten_denormalized_21',
     'full_handwritten_denormalized_22',
     'normalized_1',
     'normalized_2',
     'normalized_3',
     'normalized_4',
     'normalized_6',
     'normalized_7',
     'normalized_8',
     'normalized_9',
     'normalized_10',
     'normalized_11',
     'normalized_12',
     'normalized_13',
     'normalized_14',
     'normalized_15',
     'normalized_16',
     'normalized_17',
     'normalized_18',
     'normalized_19',
     'normalized_20',
     'normalized_21',
     'normalized_22',
     'denormalized_0',
     'denormalized_1',
     'denormalized_2',
     'denormalized_3',
     'denormalized_4',
     'denormalized_5',
     'denormalized_6',
     'denormalized_7',
     'denormalized_8',
     'denormalized_9',
     'denormalized_10',
     'denormalized_11',
     'denormalized_12',
     'denormalized_13',
     'denormalized_14',
     'denormalized_15',
     'denormalized_16',
     'denormalized_17',
     'denormalized_18',
     'denormalized_19',
     'denormalized_20',
     'denormalized_21',
     'handwritten_denormalized_0',
     'handwritten_denormalized_1',
     'handwritten_denormalized_2',
     'handwritten_denormalized_3',
     'handwritten_denormalized_4',
     'handwritten_denormalized_5',
     'handwritten_denormalized_6',
     'handwritten_denormalized_7',
     'handwritten_denormalized_8',
     'handwritten_denormalized_9',
     'handwritten_denormalized_10',
     'handwritten_denormalized_11',
     'handwritten_denormalized_12',
     'handwritten_denormalized_13',
     'handwritten_denormalized_14',
     'handwritten_denormalized_15',
     'handwritten_denormalized_16',
     'handwritten_denormalized_17',
     'handwritten_denormalized_18',
     'handwritten_denormalized_19',
     'handwritten_denormalized_20',
     'handwritten_denormalized_21',
     'handwritten_denormalized_22'
])

mydb = mysql.connector.connect(
        host="localhost",
        port=3307,
        database='tpch')

mycursor = mydb.cursor()

with open('testdata/benchmarks/tpch.yml') as f:
    y = yaml.load(f)['benchmarks']
    for bench in y:
        if 1: #bench['name'] == 'micro_handwritten_denormalized_0':
            try:
                mycursor.execute('explain ' + bench['query'])
                #mycursor.execute(bench['query'])
                print("name: ", bench['name'])
                print("PASSED")
                #drain cursor
                for x in mycursor:
                    pass
            except Exception as e:
                #only print failures
                print("name: ", bench['name'])
                print(e)
                print('\n')

